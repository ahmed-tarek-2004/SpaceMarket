<form
  [formGroup]="providerForm"
  (ngSubmit)="onProviderSubmit()"
  class="form-container space-y-4 lg:space-y-6 w-full max-w-full"
>
  <div class="form-grid grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6 w-full max-w-full">
    <!-- Company Name -->
    <div
      class="input-wrapper lg:col-span-2"
      [class.active]="
        providerForm.get('companyName')?.touched && providerForm.get('companyName')?.valid
      "
    >
      <app-input
        [formGroup]="providerForm"
        [errorMessage]="getValidationMessage('companyName')"
        controlName="companyName"
        label="Company Name"
        placeholder="Your Company Name"
        icon="building"
        [required]="true"
        class="w-full"
      ></app-input>
    </div>

    <!-- Email -->
    <div
      class="input-wrapper lg:col-span-2"
      [class.active]="providerForm.get('email')?.touched && providerForm.get('email')?.valid"
    >
      <app-input
        [formGroup]="providerForm"
        [errorMessage]="getValidationMessage('email')"
        controlName="email"
        label="Email"
        type="email"
        placeholder="your@email.com"
        icon="mail"
        [required]="true"
        class="w-full"
      ></app-input>
    </div>

    <!-- Phone Number -->
    <div
      class="input-wrapper lg:col-span-2"
      [class.active]="
        providerForm.get('phoneNumber')?.touched && providerForm.get('phoneNumber')?.valid
      "
    >
      <app-input
        [formGroup]="providerForm"
        [errorMessage]="getValidationMessage('phoneNumber')"
        controlName="phoneNumber"
        label="Phone Number"
        type="tel"
        placeholder="+201234567890"
        icon="phone"
        [required]="true"
        class="w-full"
      ></app-input>
    </div>

    <!-- Website URL -->
    <div
      class="input-wrapper lg:col-span-2"
      [class.active]="
        providerForm.get('websiteUrl')?.touched && providerForm.get('websiteUrl')?.valid
      "
    >
      <app-input
        [formGroup]="providerForm"
        [errorMessage]="getValidationMessage('websiteUrl')"
        controlName="websiteUrl"
        label="Website URL"
        type="url"
        placeholder="https://yourcompany.com"
        icon="globe"
        class="w-full"
      ></app-input>
    </div>

    <!-- Certification Files -->
    <div
      class="input-wrapper lg:col-span-2"
      [class.active]="
        providerForm.get('certificationFiles')?.touched &&
        providerForm.get('certificationFiles')?.valid
      "
    >
      <div class="file-upload-container">
        <label class="block text-sm font-medium text-gray-700 mb-2"> Certification Files </label>

        <div class="relative">
          <input
            #fileInput
            type="file"
            (change)="onCertificationFilesSelected($event)"
            multiple
            accept=".png,.jpg,.jpeg,.jfif"
            class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
            id="certificationFiles"
          />

          <div class="file-upload-area" [class.has-files]="selectedFiles.length > 0">
            <svg
              class="mx-auto h-12 w-12 text-gray-400"
              stroke="currentColor"
              fill="none"
              viewBox="0 0 48 48"
            >
              <path
                d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <p class="mt-1 text-sm text-gray-600">
              <span class="font-medium text-[#00F5D4]">Click to upload</span> or drag and drop
            </p>
            <p class="text-xs text-gray-500">PDF only, up to 10MB each (max 5 files)</p>
          </div>
        </div>

        @if (shouldShowError('certificationFiles')) {
        <p class="text-red-500 text-xs mt-1">{{ getValidationMessage('certificationFiles') }}</p>
        }

        <!-- Selected Files List -->
        @if (selectedFiles.length > 0) {
        <div class="selected-files-container">
          <div class="selected-files-header">
            <span class="text-sm font-medium text-gray-700">
              Selected files: {{ selectedFiles.length }} / 5
            </span>
            <button type="button" (click)="clearAllFiles()" class="clear-all-btn">Clear all</button>
          </div>

          <div class="files-list">
            @for (file of selectedFiles; track file.name; let i = $index) {
            <div class="file-item">
              <div class="file-info">
                <svg class="file-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  />
                </svg>
                <span class="file-name">{{ file.name }}</span>
                <span class="file-size">({{ formatFileSize(file.size) }})</span>
              </div>
              <button type="button" (click)="removeFile(i)" class="remove-file-btn">
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M6 18L18 6M6 6l12 12"
                  />
                </svg>
              </button>
            </div>
            }
          </div>

          <div class="total-size">Total size: {{ getTotalFileSize() }}</div>
        </div>
        }
      </div>
    </div>

    <!-- Password with Enhanced Strength Indicator -->
    <div
      class="input-wrapper lg:col-span-2"
      [class.active]="providerForm.get('password')?.touched && providerForm.get('password')?.valid"
    >
      <app-input
        [formGroup]="providerForm"
        [errorMessage]="getValidationMessage('password')"
        controlName="password"
        label="Password"
        type="password"
        placeholder="••••••••"
        icon="lock"
        [required]="true"
        class="w-full"
      ></app-input>

      <!-- Enhanced Password Strength Indicator -->
      <div [class]="shouldShowPasswordStrength() ? 'password-strength show' : 'password-strength'">
        <div class="strength-header">
          <span class="strength-label">Password Strength:</span>
          <span class="strength-text" [class]="getPasswordStrengthClass()">
            {{ getPasswordStrength() }}
          </span>
        </div>

        <!-- Animated Progress Bar -->
        <div class="strength-bar-container">
          <div
            class="strength-bar"
            [class]="getPasswordStrengthBarClass()"
            [style.width]="getPasswordStrengthPercentage() + '%'"
          ></div>
        </div>

        <div class="strength-hint">
          Must include uppercase, lowercase, numbers, and special characters
        </div>
      </div>
    </div>

    <!-- Confirm Password -->
    <div
      class="input-wrapper lg:col-span-2"
      [class.active]="
        providerForm.get('confirmPassword')?.touched && providerForm.get('confirmPassword')?.valid
      "
    >
      <app-input
        [formGroup]="providerForm"
        [parentFormGroup]="providerForm"
        [errorMessage]="getValidationMessage('confirmPassword')"
        controlName="confirmPassword"
        label="Confirm Password"
        type="password"
        placeholder="••••••••"
        icon="lock"
        [required]="true"
        class="w-full"
      ></app-input>
    </div>
  </div>

  <!-- Enhanced Submit Button -->
  <div class="submit-container">
    <app-button
      type="submit"
      [loading]="(isSubmitting$ | async) ?? false"
      loadingText="Creating Account..."
      label="Create Provider Account"
      color="bg-[#00F5D4]"
      hoverColor="hover:bg-[#00F5D4]/90"
      textColor="text-black"
      [additionalClasses]="'submit-btn'"
    ></app-button>
  </div>
</form>
